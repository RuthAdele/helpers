---
Name: goldfinch-helpers-canonicalurls
After: '#canonicalurls'
---

SilverStripe\Core\Injector\Injector:
  SilverStripe\Control\Middleware\CanonicalURLMiddleware:
    properties:
      ForceSSL: '`APP_FORCE_SSL`'
      ForceWWW: '`APP_FORCE_WWW`'

---
Name: goldfinch-helpers-secure-session
---

# We want to ensure cookies are not shared between secure and non-secure sessions
SilverStripe\Control\Session:
  cookie_samesite: 'Strict'
  cookie_secure: true

---
Name: goldfinch-helpers-secure-alc
After: '#coreauthentication'
Except:
  environment: dev
---

# the same treatment should be applied to the cookie responsible for remembering logins across sessions:
SilverStripe\Core\Injector\Injector:
  SilverStripe\Security\MemberAuthenticator\CookieAuthenticationHandler:
    properties:
      TokenCookieSecure: true

# FYI: For other cookies set by your application we should also ensure the users are provided with secure cookies by setting the "Secure" and "HTTPOnly" flags. These flags prevent them from being stolen by an attacker through javascript.
